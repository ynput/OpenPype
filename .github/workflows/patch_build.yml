name: ğŸ“¦ Build Zip Patch

on:
  push:
    tags:
      - '*.*.*'
      - '*.*.*-*'
      - 'CI/*.*.*-*'
  workflow_dispatch:

jobs:
  build-zip-patch:
    runs-on: [self-hosted, ubuntu]

    steps:
        
    - name: ğŸš› Checkout Code
      uses: actions/checkout@v3
      with:
        fetch-depth: 0
      
    - name: "Build Changelog"
      uses: mikepenz/release-changelog-builder-action@v3
      with:
        fromTag: "3.15.7"
        toTag: "3.15.8"
      env:
        GITHUB_TOKEN: ${{ secrets.QUAD_PUBLIC_GITHUB_TOKEN }}
            
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: 3.9

    - name: ğŸ§µ Install Requirements
      run: ./tools/create_env.sh && ./tools/fetch_thirdparty_libs.sh

    - name: ğŸ”¨ Build
      run: tools/create_zip.sh --path /prod/softprod/apps/openpype/REPOSITORY/
    
#     - name: ğŸ’¬ Message to Release chat
#       uses: julb/action-post-googlechat-message@v1
#       with:
#         message: "Bonjour,

# Voici la liste des derniÃ¨res versions dÃ©ployÃ©ğŸ¥³, viendra bientot une version spÃ©cial quad ğŸ˜

# 3.15.10 pour la prod ğŸš€

# Vous pouvez consultÃ© la liste des nouveautÃ©s depuis la 3.15.9 ici: https://github.com/ynput/OpenPype/releases/tag/3.15.10

# DÃ¨s Ã  prÃ©sent disponible dans la version prod de OpenPype 3.15.

# 3.15.10-nightly.2 pour le staging ğŸš§

# Voici la liste des issues ajoutÃ©:"
#         gchat_webhook_url: ${{ secrets.GCHAT_RELEASE_WEBHOOK_URL }}
